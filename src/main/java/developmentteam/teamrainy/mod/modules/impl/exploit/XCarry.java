package developmentteam.teamrainy.mod.modules.impl.exploit;

import developmentteam.teamrainy.api.events.eventbus.EventHandler;
import developmentteam.teamrainy.api.events.impl.PacketEvent;
import developmentteam.teamrainy.mod.gui.clickgui.ClickGuiScreen;
import developmentteam.teamrainy.mod.modules.Module;
import developmentteam.teamrainy.mod.modules.impl.misc.AutoDupe;
import net.minecraft.client.gui.screen.ChatScreen;
import net.minecraft.client.gui.screen.GameMenuScreen;
import net.minecraft.client.gui.screen.Screen;
import net.minecraft.client.gui.screen.ingame.InventoryScreen;
import net.minecraft.network.packet.c2s.play.CloseHandledScreenC2SPacket;

public class XCarry extends Module {
    public XCarry() {
        super("MoreSlots", Category.Exploit);
        setChinese("合成栏携带");
    }

    Screen lastScreen = null;
    @Override
    public void onUpdate() {
        if (mc.currentScreen != null && !(mc.currentScreen instanceof GameMenuScreen) && !(mc.currentScreen instanceof ChatScreen) && !(mc.currentScreen instanceof ClickGuiScreen)) lastScreen = mc.currentScreen;
    }

    @EventHandler
    public void onPacketSend(PacketEvent.Send event) {
        if (lastScreen instanceof InventoryScreen && event.getPacket() instanceof CloseHandledScreenC2SPacket && (AutoDupe.INSTANCE == null || !AutoDupe.INSTANCE.isOn())) {
            event.cancel();
        }
    }
}